from osgeo import ogr
import json 
import pandas as pd
geometext = 'MULTILINESTRING ZM ((-80.061885183 38.97481851 0 -2.71684257313609e-08,-80.061519238 38.9747196810001 0 0.0210489419987425,-80.0611452369999 38.974620681 0 0.0425160310260253,-80.0609852279999 38.974578681 0 0.0516923602990573,-80.06080923 38.9745326870001 0 0.0617811713455012,-80.0606342259999 38.9744836850001 0 0.0718875671591377,-80.0604582299999 38.974437681 0 0.0819765024789376,-80.060283237 38.9743916840001 0 0.0920136155473301,-80.060107237 38.9743466850001 0 0.102080802927958,-80.059932234 38.9743006790001 0 0.112118661636487,-80.059756235 38.974254683 0 0.122207596956287,-80.0595812299999 38.974208688 0 0.132245331391459,-80.059405238 38.974159683 0 0.142402368859621,-80.059222232 38.9741136870001 0 0.15285325217701,-80.0590552369999 38.9740636830001 0 0.162575765643851,-80.058879228 38.974017685 0 0.172665322344983,-80.058704236 38.9739726830001 0 0.182680563186295,-80.0585282329999 38.9739226830001 0 0.192861709801946,-80.058345227 38.9738766840001 0 0.203312655256013,-80.058170236 38.973831681 0 0.2133278339752,-80.058002233 38.9737776810001 0 0.223204198628082,-80.0578262339999 38.973724679 0 0.233458542628796,-80.0576582319999 38.973670681 0 0.243334783022874,-80.05749023 38.973605682 0 0.253527362860041,-80.057323234 38.973541679 0 0.263640220917296,-80.057162233 38.973468682 0 0.273761218923028,-80.057010232 38.9733926820001 0 0.283573458218598,-80.056857239 38.9733086860001 0 0.293740996829001,-80.05671223 38.9732206830001 0 0.303725479869172,-80.056567231 38.973125688 0 0.314015614785603,-80.0564382319999 38.9730266770001 0 0.323849788415828,-80.056308233 38.9729236810001 0 0.333918529213406,-80.0561862329999 38.9728166800001 0 0.343893629571539,-80.056071233 38.972701683 0 0.354052841823432,-80.055957226 38.9725836810001 0 0.364345089401468,-80.05585823 38.972461679 0 0.374401899898658,-80.055766235 38.9723356810001 0 0.384501025677309,-80.055682239 38.9722056790001 0 0.394640354104922,-80.055606231 38.972076685 0 0.404527779159253,-80.055537235 38.9719386840001 0 0.414843763064709,-80.055469234 38.971805682 0 0.42481600510655,-80.055415228 38.9716686790001 0 0.434797940513818,-80.055370233 38.971526683 0 0.444984182380722,-80.055339235 38.971385678 0 0.454946855330491,-80.0553082279999 38.9712406850001 0 0.465183490290656,-80.055286229 38.9710956820001 0 0.475351650267839,-80.055270228 38.97095468 0 0.485209063146613,-80.055255231 38.9708096780001 0 0.495339443848934,-80.05524023 38.970664685 0 0.505469141047797,-80.055232227 38.9705196850001 0 0.515575909681502,-80.055225228 38.970374684 0 0.525680503531476,-80.055217227 38.970229685 0 0.535787147891824,-80.0552022369999 38.9700856800001 0 0.545848307971028,-80.0551942279999 38.96994368 0 0.555746358455508,-80.055186227 38.9697986800001 0 0.565853127089213,-80.055179228 38.9696536800001 0 0.575957658802508,-80.055171226 38.969508681 0 0.586064303162857,-80.055164227 38.9693646860001 0 0.596098868612899,-80.055156235 38.9692196870001 0 0.606205512973247,-80.0551412249999 38.9690746840001 0 0.616336017948925,-80.055125232 38.968929685 0 0.626470623959904,-80.0551102269999 38.96878868 0 0.636323687256663,-80.055087237 38.9686436850001 0 0.646497688125237,-80.05506423 38.968501684 0 0.656465083477087,-80.055034232 38.968356682 0 0.666693392078741,-80.055003232 38.968215684 0 0.676655630071764,-80.054950226 38.968074684 0 0.686888536816696,-80.0548962349999 38.9679376810001 0 0.69687028581393,-80.054835225 38.967803686 0 0.706773245110526,-80.054767227 38.967666679 0 0.717005157654057,-80.054683226 38.9675366860001 0 0.727144051124924,-80.05459923 38.9674106790001 0 0.737035825761268,-80.0545072309999 38.967285686 0 0.747074554397841,-80.0544082339999 38.9671626860001 0 0.757190332893515,-80.054301225 38.9670446860001 0 0.767258390187635,-80.054187228 38.966930678 0 0.777329927150276,-80.0540652339999 38.9668196800001 0 0.787514801995712,-80.053943235 38.9667126790001 0 0.797490213022684,-80.053813237 38.966613684 0 0.807362911611563,-80.053676227 38.966514681 0 0.817512306224671,-80.053531232 38.9664226790001 0 0.827670089332969,-80.053457634 38.9663785220001 0 0.832716296834406,-80.0533862249999 38.9663356790001 0 0.837612381350482,-80.053233233 38.9662556800001 0 0.847623024063068,-80.053073227 38.96617868 0 0.857841577148065,-80.052913226 38.9661066830001 0 0.867881424244842,-80.052745224 38.9660416780001 0 0.878074998268858,-80.0525772299999 38.965980685 0 0.888147280871635,-80.052409235 38.9659196860001 0 0.898219812035677,-80.052241232 38.9658626780001 0 0.908178694618982,-80.052066226 38.9658046850001 0 0.918514500226593,-80.051898224 38.965747677 0 0.928473320687772,-80.0517232349999 38.965694684 0 0.938677333717351,-80.051555234 38.9656376780001 0 0.948636092041852,-80.051379229 38.965583678 0 0.95891696853505,-80.051211231 38.965526681 0 0.968875354024931,-80.0510442349999 38.9654696800001 0 0.978783967788331,-80.0508682299999 38.96541568 0 0.989064844296081,-80.050693224 38.965358682 0 0.999373868849943,-80.0505252309999 38.9653056770001 0 1.00922444666503,-80.050357229 38.9652516780001 0 1.01910174338263,-80.050182236 38.9651946770001 0 1.02941020870639,-80.050014232 38.965141681 0 1.03926122146368,-80.0498382339999 38.965083684 0 1.049646860949,-80.049670232 38.9650306790001 0 1.05949799797963,-80.049495227 38.964973679 0 1.06980708468473,-80.0493272259999 38.9649196840001 0 1.0796841949923,-80.0491522309999 38.9648626810001 0 1.08999284672609,-80.04898423 38.964809685 0 1.09984373522457,-80.048808229 38.9647556830001 0 1.11012461171777,-80.0486402229999 38.9646986830001 0 1.1200835564523,-80.0484652219999 38.964645682 0 1.13028837725869,-80.048297229 38.9645886810001 0 1.1402468248998,-80.048122233 38.964534685 0 1.15047668691841,-80.047954233 38.964481678 0 1.16032788610028,-80.0477782249999 38.9644246830001 0 1.1706871794886,-80.047610229 38.9643706790001 0 1.18056441406952,-80.047435225 38.964313684 0 1.19087331435003,-80.047267233 38.964256678 0 1.20083182412782,-80.0470922279999 38.9642026820001 0 1.21106224537652,-80.0469242299999 38.9641496840001 0 1.22091307173832,-80.046756224 38.9640926800001 0 1.23087226501957,-80.0465802259999 38.964038681 0 1.24115295510273,-80.0464132279999 38.9639816860001 0 1.25106169313949,-80.0462372229999 38.9639246790001 0 1.26142123507452,-80.046069227 38.963870683 0 1.27129828324541,-80.045894226 38.9638136830001 0 1.2816072456626,-80.0457262319999 38.9637606840001 0 1.29145800988772,-80.04555823 38.9637036780001 0 1.30141707889561,-80.045383225 38.963649687 0 1.31164743800764,-80.0452152299999 38.963596683 0 1.32149838864279,-80.045039227 38.963538681 0 1.33188458734367,-80.044871228 38.963481684 0 1.34184334566817,-80.044704225 38.9634286790001 0 1.35164433815225,-80.0445282219999 38.963371678 0 1.36200369367725,-80.044353228 38.963313683 0 1.37233925073815,-80.044185233 38.963260678 0 1.38219026349543,-80.044017227 38.9632076840001 0 1.39204152481398,-80.043842233 38.963149677 0 1.40237745469494,-80.0436742269999 38.9630966830001 0 1.41222877815017,-80.043498225 38.963039683 0 1.42258807153848,-80.043330222 38.9629856810001 0 1.43246574107616,-80.0431622249999 38.9629286800001 0 1.44242456152278,-80.0429872239999 38.9628756820001 0 1.45262956875376,-80.042819225 38.962818682 0 1.46258845135162,-80.042644234 38.9627606820001 0 1.47292407053465,-80.04247623 38.962707686 0 1.48277539398987,-80.042308226 38.962653684 0 1.49265312566422,-80.042133222 38.9625966790001 0 1.5029625230527,-80.041965224 38.962539678 0 1.51292146777268,-80.041789233 38.9624866790001 0 1.52317674383812,-80.041621225 38.9624286800001 0 1.5331640230288,-80.0414542249999 38.9623716770001 0 1.54307319602231,-80.041278222 38.962318677 0 1.55332921772788,-80.041110224 38.9622616840001 0 1.56328785177902,-80.040935229 38.962207676 0 1.57351833516441,-80.040759227 38.9621546770001 0 1.58377423259662,-80.040591219 38.962097682 0 1.59373348801455,-80.0404242239999 38.962043684 0 1.6035605158977,-80.040248229 38.96199468 0 1.6137192932074,-80.040073223 38.9619406800001 0 1.6239501494274,-80.039897222 38.961894683 0 1.63404082457419,-80.0397222239999 38.9618496800001 0 1.64405799166707,-80.0395462289999 38.9618076780001 0 1.65406353914295,-80.0393632179999 38.961768679 0 1.66437747252348,-80.039188222 38.9617306810001 0 1.67425278086739,-80.0390042229999 38.961696685 0 1.6845327874471,-80.0388212249999 38.9616656790001 0 1.69471362337936,-80.038638229 38.9616396800001 0 1.70482617075322,-80.03845523 38.961616683 0 1.71490354860725,-80.038272224 38.961597678 0 1.72494091022236,-80.0380812189999 38.9615826790001 0 1.73537787485111,-80.037898221 38.9615666830001 0 1.74538932534051,-80.0377152199999 38.961551683 0 1.75539344365825,-80.037532223 38.9615406790001 0 1.76537214795826,-80.037341227 38.961528679 0 1.77578985011496,-80.037158232 38.9615176830001 0 1.78576836800494,-80.036967224 38.9615056800001 0 1.79618669152842,-80.0367842269999 38.9614946840001 0 1.80616539582843,-80.0366012229999 38.9614826800001 0 1.81615006526408,-80.0364102189999 38.9614676790001 0 1.82658702989283,-80.0362272249999 38.96145668 0 1.83656560991949,-80.036044218 38.9614446780001 0 1.84655040364305,-80.035854225 38.961433678 0 1.85690839214658,-80.035670228 38.9614216850001 0 1.86694674794853,-80.035614236 38.961418317 0 1.86999997348175,-80.0356138609999 38.9614183050001 0 1.87001942234929,-80.0354872199999 38.9614106760001 0 1.87659699609503,-80.035297229 38.9613986800001 0 1.88646776841779,-80.035113225 38.961383676 0 1.89604817457439,-80.034923224 38.961376681 0 1.90589819315937,-80.034740228 38.96136068 0 1.91543386067497,-80.0345572259999 38.961345684 0 1.92496263099019,-80.0343732279999 38.961334677 0 1.93451886584808,-80.0341832249999 38.9613226770001 0 1.94439019741549,-80.034000217 38.9613116780001 0 1.95389523140329,-80.0338092229999 38.9612996770001 0 1.96381788811414,-80.0336262289999 38.961288677 0 1.97332217646181,-80.033443222 38.961276679 0 1.9828324920818,-80.033252225 38.9612656840001 0 1.99275005357049,-80.033069223 38.961253685 0 2.00226018278045,-80.032878228 38.961242681 0 2.01217768213246,-80.0326952199999 38.961231679 0 2.02168284039362,-80.032512229 38.961219681 0 2.03119228610012,-80.0323292209999 38.9612086760001 0 2.04069738222461,-80.032138222 38.96120068 0 2.05060245416826,-80.031947224 38.9611896850001 0 2.06052007779363,-80.031764228 38.9611856830001 0 2.07000025697926,-80.031581223 38.9611816830001 0 2.07948087112163,-80.031390227 38.961177681 0 2.08937513123965,-80.031207224 38.9611776830001 0 2.09885189289344,-80.031016225 38.961181681 0 2.10874633942149,-80.03083322 38.9611896850001 0 2.11823807607288,-80.0306432199999 38.961196677 0 2.12808809465787,-80.0304602269999 38.96120468 0 2.13757927207917,-80.030276229 38.9612196780001 0 2.14715936755238,-80.0300932229999 38.961234683 0 2.15668838641432,-80.029903223 38.9612536820001 0 2.16660787415458,-80.029719222 38.961276679 0 2.17625768732978,-80.029536224 38.961299683 0 2.18585623748368,-80.0293532219999 38.961326682 0 2.19550064475334,-80.029170221 38.961356681 0 2.20518394977262,-80.028987226 38.9613916800001 0 2.21494051429909,-80.0288122219999 38.961425686 0 2.2242795182392,-80.028628227 38.9614636850001 0 2.23413531554979,-80.02845322 38.9615056800001 0 2.24361642678559,-80.028270218 38.961543686 0 2.25342270091642,-80.028094219 38.9615896780001 0 2.26303367847868,-80.027919222 38.9616396800001 0 2.27268367806391,-80.027743217 38.961688678 0 2.28236008588283,-80.027568221 38.9617426780001 0 2.29210428515216,-80.0274002259999 38.9617956820001 0 2.30148740635195,-80.027225223 38.9618526790001 0 2.31130672925792,-80.027057221 38.9619136850001 0 2.32090155119658,-80.026881225 38.9619716780001 0 2.33079388506303,-80.026714214 38.962032682 0 2.34034216638247,-80.026546212 38.962093684 0 2.34993692618445,-80.026378226 38.96215468 0 2.35953069179959,-80.0262022219999 38.96221568 0 2.36950262315804,-80.0260342189999 38.9622766840001 0 2.3790974450967,-80.025867219 38.9623376850001 0 2.38864504291269,-80.0256992229999 38.9623946830001 0 2.39813056588173,-80.025523219 38.962455683 0 2.4081024351035,-80.025355228 38.962516684 0 2.41769657353871,-80.025188229 38.962577686 0 2.42724417135469,-80.025020222 38.962638677 0 2.43683874474664,-80.024844217 38.962699677 0 2.44681067610509,-80.024676224 38.962760686 0 2.45640512522368,-80.024509214 38.9628256820001 0 2.46606848426745,-80.024341217 38.962882678 0 2.47555388296314,-80.0241732229999 38.962943679 0 2.4851481456717,-80.024005221 38.963008684 0 2.49485773463675,-80.023837224 38.9630656790001 0 2.50434307118121,-80.023662225 38.963130678 0 2.51437844442262,-80.023494221 38.96318868 0 2.52389087270421,-80.023326214 38.9632496770001 0 2.5334856325062,-80.023158219 38.963310687 0 2.54308008162479,-80.0229832269999 38.963371683 0 2.55300391894707,-80.022815217 38.9634326790001 0 2.56259867874905,-80.0226472209999 38.9634936790001 0 2.57219294145762,-80.0224792229999 38.9635546850001 0 2.58178745269834,-80.0223112159999 38.963615685 0 2.59138221250032,-80.022136222 38.9636766850001 0 2.6013061741105,-80.0219682219999 38.9637376850001 0 2.61090056109242,-80.0218002249999 38.963798679 0 2.62049469951307,-80.0216322269999 38.963859686 0 2.63008921076835,-80.021464217 38.963920682 0 2.63968390843365,-80.021297222 38.9639816860001 0 2.64923119556624,-80.0211292239999 38.9640426830001 0 2.65882539613813,-80.020953221 38.9641036830001 0 2.66879707894986,-80.0207852189999 38.964160684 0 2.67828272619226,-80.020618224 38.9642216780001 0 2.68782976477814,-80.020450221 38.9642826840001 0 2.69742440030677,-80.020274219 38.964343682 0 2.70739595884515,-80.020106219 38.9644046870001 0 2.71699040796375,-80.0199392229999 38.964465681 0 2.72653750868631,-80.0197632169999 38.9645276860001 0 2.73653640750854,-80.019595217 38.9645886810001 0 2.74613060806587,-80.019427213 38.9646496820001 0 2.75572518145782,-80.019260215 38.9647106840001 0 2.76527246860496,-80.0190922199999 38.964767683 0 2.77475761873939,-80.018916215 38.964828681 0 2.78472930155112,-80.018748213 38.964889683 0 2.79432375066972,-80.0185812139999 38.964950683 0 2.80387103780231,-80.0184132219999 38.965011684 0 2.8134649276908,-80.018237217 38.9650726830001 0 2.82343654836586,-80.018069225 38.965133683 0 2.83303043825435,-80.017902224 38.965194683 0 2.84257778752362,-80.01773422 38.9652556820001 0 2.85217223664222,-80.017566223 38.9653126870001 0 2.86165763532335,-80.017390215 38.965373684 0 2.87162925599841,-80.017223218 38.9654316840001 0 2.88109377666842,-80.01705522 38.965495683 0 2.89077353986795,-80.016879221 38.965556688 0 2.90074497413298,-80.016711222 38.965614687 0 2.91025690532115,-80.01654422 38.9656756850001 0 2.91980425460497,-80.0163762239999 38.9657366820001 0 2.92939808234223,-80.016208217 38.965797681 0 2.9389925935975,-80.016032218 38.9658586850001 0 2.94896402786253,-80.015865214 38.9659196810001 0 2.95851131499512,-80.015697217 38.9659806880001 0 2.968105515567,-80.015529221 38.9660416850001 0 2.97769946759217,-80.015361212 38.966102682 0 2.98729391671077,-80.015193214 38.966163678 0 2.99688786872139,-80.0150182149999 38.9662206850001 0 3.00670675667061,-80.0148502169999 38.9662816790001 0 3.01630064654455,-80.014682219 38.966342685 0 3.02589484711643,-80.014514221 38.9664036820001 0 3.0354887991416,-80.014339212 38.9664646800001 0 3.0454131335573,-80.014171221 38.9665226860001 0 3.05492475406209,-80.0140032159999 38.9665796850001 0 3.06441027703113,-80.013827221 38.9666326870001 0 3.07417802621785,-80.01365222 38.9666826870001 0 3.08382752870966,-80.013477213 38.9667316810001 0 3.09345466189552,-80.013376329 38.966757923 0 3.09896086956724,-80.0130750879999 38.966837465 0 3.11542748390639,-80.0128732169999 38.966880685 0 3.12626653703046,-80.012477216 38.9669476830001 0 3.14724783902057,-80.011887217 38.967018684 0 3.17815925416653,-80.0110762159999 38.967057685 0 3.22023314550461,-80.010758217 38.9670526840001 0 3.23670274243341,-80.0101752159999 38.9670256850001 0 3.26694407222385,-80.009691217 38.966972684 0 3.29225128966209,-80.009350218 38.966924684 0 3.31019322268548,-80.009101216 38.966880684 0 3.32341293049103,-80.008647216 38.9667806850001 0 3.3478392938996,-80.0081432169999 38.9666486830001 0 3.37536641761835,-80.007683216 38.966497684 0 3.40120577628841,-80.0069052169999 38.9661886850001 0 3.44640540701221,-80.006188213 38.965865685 0 3.48927086152253,-80.0022602129999 38.9641506830001 0 3.72231957571057,-79.996604213 38.961660683 0 4.05856565966678,-79.995830213 38.9613286840001 0 4.10429805298918,-79.994979212 38.960993683 0 4.15365216319333,-79.993794212 38.9605926830001 0 4.22053418762516,-79.992773211 38.960313684 0 4.27655242841865,-79.992358618 38.960211035 0 4.29907615702541,-79.99143895 38.959984159 0 4.34902299204259,-79.991382646 38.959973652 0 4.3520208534901,-79.9912672089999 38.959949685 0 4.35820665347273,-79.991084211 38.9599186880001 0 4.36790387718065,-79.990726207 38.959853685 0 4.38693830285047,-79.990543206 38.959823681 0 4.39662191855314,-79.990359209 38.959796688 0 4.40631721600948,-79.990176213 38.959770678 0 4.41594963082753,-79.989918356 38.9597324280001 0 4.42954191206081,-79.989909666 38.959731139 0 4.42999998599407))'



def parsems(mytext):
    mytext = mytext.replace('MULTILINESTRING ZM','')
    mytext = mytext.strip()[1:-1]
    vals = mytext.split('),(')
    # val represents a single line 
    totalms = []
    for val in vals:
        linems = [float(e.split(' ')[-1]) for e in val.strip()[1:-1].split(',')]
        totalms.append(linems)
    return totalms


ex = ogr.GetDriverByName('OpenFileGDB')
f = ex.Open(r'C:\Users\E025205\Downloads\Dominant_Routes_12_31_2022.gdb\Dominant_Routes_2022.gdb')
l = f.GetLayerByIndex(0)
fc = l.GetFeatureCount()
newlist = []
errors = []
for i in range(1,fc+1):
    try:
        feat = l.GetFeature(i)
        props = json.loads(feat.ExportToJson()) 
        props = props.get('properties') 

        geom = feat.GetGeometryRef()
        wkt = geom.ExportToIsoWkt()
        measures = parsems(wkt)
        props['measures'] = str(measures)
        newlist.append(props)

        if i % 10 == 0: print(f'[{i}/{fc}]')
    except:
        try:
                
            feat = l.GetFeature(i)
            props = json.loads(feat.ExportToJson()) 
            props = props.get('properties')
            geom = feat.GetGeometryRef()
            wkt = geom.ExportToIsoWkt()
            props['wkt'] = wkt
            errors.append(props)
        except:
            pass

df = pd.DataFrame(newlist)
errors_df = pd.DataFrame(errors)
df.to_csv('measures.csv',index=False)
errors_df.to_csv('errors.csv', index=False)
    

# l.GetFeature(1)
# feat = l.GetFeature(1)



print(parsems(geometext))


